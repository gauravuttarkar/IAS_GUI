{% extends 'home/templates/base_template.html' %}

{% block styles %}
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <!-- <style type="text/css">
    label, p, div{
      color:black;
    }
  </style> -->
{% endblock %}

{% block content %}
<CENTER> 
  <h2>Blind signature attack</h2>
  <form style="width:100%" action="/blindSubmit" method="POST" class="form-group col-sm-4" >
     <div class="container-fluid" style="margin-left:20%;margin-right: 20%;width:40%;margin-top: 30px;margin-bottom: 20px ">
    <label for="cipher" style="color: black;margin:10px">Enter plain text</label>
    <input  type="text" name="cipher" id="cipher" class="form-control">
    <label for="p" style="color: black;margin:10px">Enter p</label>
    <input  type="text" name="p" class="form-control">
    <label for="q" style="color: black;margin:10px">Enter q</label>
    <input  type="text" name="q" class="form-control">
    <label for="r" style="color: black;margin:10px">Enter r</label>
    <input  type="text" name="r" class="form-control">
    <label for="e" style="color: black;margin:10px">Enter e</label>
    <input  type="text" name="e" class="form-control">
    <input type="submit" style="margin-top:10px" name="submit" class="form-control btn btn-success">
  </div>
  </form>
  </CENTER>
  <center>
  {% if flag %}
  <h2>{{ output }}</h2>
   
  {% else %}
  {% if output|length > 0 %}
  <h3>D value: {{ d }}</h3>
  <h3>R Inverse: {{ rInv }} </h3>
  <h3>Blind signatures</h3>
  {% for out in output|slice:":-1" %}
  <p>{{out}}</p>
  {% endfor %}
  <h3>Original message: <strong>{{ output|last}}</strong></h3>
  {% endif %}
  {% endif %} 
</center>
{% endblock %}